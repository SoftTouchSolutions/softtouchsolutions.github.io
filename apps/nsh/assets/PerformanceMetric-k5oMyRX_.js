import{r as i,j as e}from"./mui-CVeSmhdP.js";import{B as m,T as q,x as U,y as N,z as y,p as Y,q as H,r as _,F as S,L as G,I as v,A as f,S as a}from"./index-Cjmwo3Rz.js";import"./vendor-CC_ZIGTP.js";import"./utils-ngrFHoWO.js";const Z=()=>{const[n,l]=i.useState(!1),o=()=>l(!n),[c,D]=i.useState([]),[d,P]=i.useState(1),x=3,[C,E]=i.useState({metricName:""}),[M,I]=i.useState({}),[u,g]=i.useState(null),b=d*x,F=b-x,k=c.slice(F,b),w=Math.ceil(c.length/x),h=async()=>{try{const r=await f.getAllPerformanceMetrics();console.log("API Response:",r),D(r||[])}catch(r){console.error("Error fetching metrics:",r),a.fire("Error","Failed to fetch metrics","error")}};i.useEffect(()=>{h()},[]);const A=r=>{const{name:t,value:s}=r.target;E(p=>({...p,[t]:s}))},B=r=>{const{name:t,value:s}=r.target;I(p=>({...p,[t]:s}))},z=async r=>{r.preventDefault();try{await f.createPerformanceMetric(C),await a.fire("Success","Metric added successfully","success"),h(),E({metricName:""}),o()}catch(t){console.error("Error adding metric:",t),a.fire("Error","Failed to add metric","error")}},R=async r=>{var t;if(r.preventDefault(),console.log("Submitting edit for ID:",u),!u||isNaN(u)){a.fire("Error","Invalid metric selection","error");return}try{const s=await f.updatePerformanceMetric(u,M);console.log("Update response:",s),await a.fire("Success","Metric updated successfully","success"),h(),g(null)}catch(s){console.error("Update error:",((t=s.response)==null?void 0:t.data)||s.message),a.fire("Error","Failed to update metric","error")}},L=(r,t)=>{if(r.preventDefault(),console.log("Editing metric:",t),!t||typeof t!="object"){a.fire("Error","Invalid metric data","error");return}const s=t.sno;if(!s||isNaN(s)||s<=0){a.fire("Error","Invalid metric ID format","error");return}g(s),I({metricName:t.metricName}),l(!1)},O=()=>g(null),T=async r=>{if((await a.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await f.deletePerformanceMetric(r),await a.fire("Deleted!","Metric has been deleted.","success"),h()}catch(s){console.error("Error deleting metric:",s),a.fire("Error","Failed to delete metric","error")}},j=r=>P(r);return e.jsxs("div",{className:"app-container",children:[e.jsx(m,{color:"primary",className:"mb-3",onClick:o,children:"Add New Metric"}),e.jsxs(q,{bordered:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Metric Name"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:k.map(r=>e.jsx(i.Fragment,{children:u===r.sno?e.jsx(J,{editFormData:M,handleEditInputChange:B,handleEditFormSubmit:R,handleCancelClick:O}):e.jsx(K,{metric:r,handleEditClick:L,handleDeleteClick:T})},r.sno))})]}),e.jsxs(U,{className:"pagination justify-content-end",children:[e.jsx(N,{disabled:d===1,children:e.jsx(y,{onClick:()=>j(d-1),children:"«"})}),[...Array(w)].map((r,t)=>e.jsx(N,{active:d===t+1,children:e.jsx(y,{onClick:()=>j(t+1),children:t+1})},t)),e.jsx(N,{disabled:d===w,children:e.jsx(y,{onClick:()=>j(d+1),children:"»"})})]}),e.jsxs(Y,{isOpen:n,toggle:o,children:[e.jsx(H,{toggle:o,children:"Add New Metric"}),e.jsx(_,{children:e.jsxs(S,{onSubmit:z,children:[e.jsx(G,{for:"metricName",children:"Metric Name"}),e.jsx(v,{type:"text",id:"metricName",name:"metricName",value:C.metricName,onChange:A,required:!0}),e.jsx(m,{color:"primary",className:"mt-3",type:"submit",children:"Add Metric"})]})})]})]})},J=({editFormData:n,handleEditInputChange:l,handleEditFormSubmit:o,handleCancelClick:c})=>e.jsx("tr",{children:e.jsx("td",{colSpan:2,children:e.jsxs(S,{onSubmit:o,className:"d-flex align-items-center gap-2",children:[e.jsx(v,{type:"text",name:"metricName",value:n.metricName,onChange:l,required:!0,className:"flex-grow-1"}),e.jsx(m,{size:"sm",color:"success",type:"submit",children:"Save"}),e.jsx(m,{size:"sm",color:"danger",onClick:c,children:"Cancel"})]})})}),K=({metric:n,handleEditClick:l,handleDeleteClick:o})=>e.jsxs("tr",{children:[e.jsx("td",{children:n.metricName}),e.jsxs("td",{children:[e.jsx(m,{size:"sm",color:"warning",onClick:c=>{console.log("Edit clicked for:",n),l(c,n)},className:"me-2",children:"Edit"}),e.jsx(m,{size:"sm",color:"danger",onClick:()=>{const c=n.sno;console.log("Delete ID:",c),c!=null?o(c):(console.error("Cannot delete metric with undefined ID"),a.fire("Error","Cannot delete this metric - ID is missing","error"))},children:"Delete"})]})]});export{Z as default};
